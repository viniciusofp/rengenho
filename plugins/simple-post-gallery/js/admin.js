if("undefined"==typeof jQuery)throw new Error("Wordpress Media Gallery requires jQuery");!function(a){"use strict";a.fn.mediaUploader=function(b){var c=this;return c.settings=a.extend({editor:void 0,render:!0,clearTemplate:!0,clearTarget:!0,target:void 0,success:void 0,template:void 0},b),c._getTemplate=function(){void 0==c.settings.template&&(c.settings.template=a(c).html(),c.settings.clearTemplate&&a(c).html(""))},c._render=function(b){c.settings.render&&void 0!=c.settings.target&&a(c.settings.target).length>0&&(c.settings.clearTarget&&a(c.settings.target).html(""),a.each(b,function(b){a(c.settings.target).append(c._parseMedia(this))}))},c._parseMedia=function(b){if(void 0==c.settings.template)return"";var d=c.settings.template;return a.each(b,function(a){d=d.replace(new RegExp("{{"+a+"}}","g"),b[a],d),d=d.replace(new RegExp("{{ "+a+" }}","g"),b[a],d)}),d=a(d),"file"==b.type&&a(d).find("img").length>0&&a(d).find("img").remove(),"image"==b.type&&a(d).find("img").length>0&&a(d).find("img").attr("src",b.url),d},c._parseEditorHTML=function(b){var d=[];a.each(a(b),function(b){a(this).find("img").length>0?d.push({type:"image",url:a(this).find("img").attr("src"),alt:a(this).find("img").attr("alt"),id:a(this).find("img").attr("class").replace(/[A-Za-z\-\s]/g,"")}):a(this).is("img")?d.push({type:"image",url:a(this).attr("src"),alt:a(this).attr("alt"),id:a(this).attr("class").replace(/[A-Za-z\-\s]/g,"")}):void 0!=a(this).attr("href")&&d.push({type:"file",url:a(this).attr("href")})}),c._render(d),void 0!=c.settings.success&&c.settings.success(d)},c.prev_send_to_editor=window.send_to_editor,window.send_to_editor=function(a,b){return void 0==c.settings.editor||this.activeEditor!=c.settings.editor&&b!=c.settings.editor?void 0==c.prev_send_to_editor?void 0:c.prev_send_to_editor(a,void 0==this.activeEditor?b:this.activeEditor):void c._parseEditorHTML(a)},c._getTemplate(),c._add_media=function(a){var b=[];if(a.constructor!==Array){var d=a;a=[],a.push(d)}for(var e in a){var d={};(void 0!==a[e].type||void 0!==a[e].url)&&(d.type=a[e].type,d.url=a[e].url,void 0!==a[e].alt&&(d.alt=a[e].alt),void 0!==a[e].id&&(d.id=a[e].id),b.push(d))}c._render(b),void 0!=c.settings.success&&c.settings.success(b)},this.add=c._add_media,this}}(jQuery),function(a){a(document).ready(function(){a(".gallery-uploader").each(function(b){window["postGallery"+(0===b?"":"_"+b)]=a(this).mediaUploader({editor:a(this).data("editor"),target:a(this).data("target"),clearTarget:a(this).data("clearTarget")|!1})}),a(".sortable").each(function(){a(this).sortable()}),a(document).on("click",".remove.from-gallery",function(b){b.preventDefault();var c=a(this).closest(".attachment");c.length>0&&c.remove()}),a(".scroll-to").click(function(b){b.preventDefault(),a("html, body").animate({scrollTop:a(a(this).data("marker")).offset().top+(void 0==a(this).data("offset")?0:parseInt(a(this).data("offset")))},1e3,"swing")})})}(jQuery);